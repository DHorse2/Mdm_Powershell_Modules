<!-- $fullHtml = @" -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mdm_Bootstrap Help by MacroDM for PowerShell</title>
    <meta name="author" content="David G. Horsman">
    <meta name="date" content="04/28/2025 10:57:05">
    <meta name="copyright" content="&copy; David G. Horsman. All rights reserved.">
    <meta name="license" content="MIT">
    <style>
        html,
        body {
            background-color: white;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 3px;
            padding: 18px;
        }

        h2 {
            color: #2c3e50;
        }

        pre {
            background-color: #f4f4f4;
            padding: 10px;
            border: 1px solid #ddd;
        }

        pre {
            white-space: pre-wrap;
        }

        .wrapper {
            /* float on right edge */
            float: left;
            vertical-align: top;
            margin-right: 10px;

            /* Allows the wrapper to sit next to the heading */
            /* display: inline-block; */
            /* margin-left: 10px; */
            /* vertical-align: middle; */
        }

        .circle {
            width: 40px;
            /* Set the size of the circle */
            height: 40px;
            /* Set the size of the circle */
            border-radius: 50%;
            /* Makes it round */
            background-color: #ccc;
            /* Background color for the outer circle */
            display: flex;
            /* Centers the button inside the circle */
            justify-content: center;
            /* Centers the button horizontally */
            align-items: center;
            /* Centers the button vertically */
        }

        .btn {
            background-color: transparent;
            /* Button background */
            border: none;
            /* No border */
            cursor: pointer;
            /* Pointer cursor on hover */
        }

        .outer {
            width: 35px;
            height: 35px;
            background-color: #3c249c;
        }

        .inner {
            width: 25px;
            height: 25px;
            background-color: #6754b0;
        }

        .dark-mode {
            filter: invert(100%)
        }
    </style>
</head>

<body>
    <script>
        function toggleDarkMode(element) {
            if (element == null) { var element = document.body; }
            element.classList.toggle("dark-mode");
        }

        function myClassClick(className, toggleName) {
            let ClassItem = document.querySelector(className)
            ClassItem.addEventListener('click', () => {
                document.documentElement.classList.toggle(toggleName)
            })
        }
    </script>
    <div>
        <div class="wrapper">
            <div class="circle outer">
                <div class="circle inner">
                    <button class="darkModeButton" type="button" onclick="toggleDarkMode()">dark mode</button>
                </div>
            </div>
        </div>
        <h1>Help for Module: Mdm_Bootstrap</h1>
    </div>
    <h1>Mdm_Bootstrap</h1>
<pre>NAME
Mdm Bootstrap

SYNOPSIS
    Bootstrap the (MDM) Development Environment on a Windows 10/11 platform.

DESCRIPTION
    Set registry, Path and load PowerShell modules
    This is the first step of setting up the Development Environment.
    The Initialize-Dev_Env_Win function is the main function.
    This updates the Windows Environment variables.
    It installs these powershell modules to the system's directories.
    It sets registry, Path and load PowerShell modules.
    It can elevate its own permissions if needed.

OUTPUTS
    The Mdm Bootstrap Module functions.

EXAMPLE
    Import-module Mdm_Bootstrap

NOTES
    I originally had each function a .ps1 file:
    I had issues. It is the "dot sourcing" issue found online.
    The solution needs Full Language Mode to run.
    ```powershell
        . "$PSScriptRoot\Assert-SecElevated.ps1"
        . "$PSScriptRoot\Export-ModuleMemberScan.ps1"
        . "$PSScriptRoot\Get-DirectoryNameFromSaved.ps1"
        . "$PSScriptRoot\Get-FilesNamesFromSaved.ps1"
        . "$PSScriptRoot\Set-SavedToDirectoryName.ps1"
        . "$PSScriptRoot\Set-LocationToPath"
        . "$PSScriptRoot\Wait-AnyKey.ps1"
        . "$PSScriptRoot\Wait-CheckDoPause.ps1"
        . "$PSScriptRoot\Wait-YorNorQ.ps1"
    ```
    I now have a module .psm1 file but the .ps1 file are components or classes:
    ```powershell
        . "$PSScriptRoot\Mdm_Std_Library.psm1"
        . "$PSScriptRoot\Mdm_Std_Help.ps1"
        . "$PSScriptRoot\Mdm_Std_Etl.ps1"
        . "$PSScriptRoot\Mdm_Std_Script.ps1"
        . "$PSScriptRoot\Mdm_Std_Error.ps1"
        . "$PSScriptRoot\Mdm_Std_Module.ps1"
    ```

    You have to dot source ". xxx" these in your .PSM1 file.
    Also: See function Export-ModuleMember. 
    This also failed for the same reasons.
    
    Regardless: This is powershell best practices,
    and similar to modules in the wild.
    Additionally, the PSM1 file get unwieldly large
    while using the above technique isolates the functions
    making them easier to find.

    (It seems) the main difference is they typically use .net (C#).
    That isn't a barrier beyond wanting to master (THIS) powershell syntax.

    SOLUTION: This was caused by the registry's environment setting:
        __PSLockDownPolicy
    This is 4 (Constrained) and needs to be (8) Full Language Mode
    Note: This reduces the security of the system. todo
    The bootstrap modules contains solution to alter this setting.
</pre>
<pre>NAME
Mdm Bootstrap

SYNOPSIS
    Bootstrap the (MDM) Development Environment on a Windows 10/11 platform.

DESCRIPTION
    Set registry, Path and load PowerShell modules
    This is the first step of setting up the Development Environment.
    The Initialize-Dev_Env_Win function is the main function.
    This updates the Windows Environment variables.
    It installs these powershell modules to the system's directories.
    It sets registry, Path and load PowerShell modules.
    It can elevate its own permissions if needed.

OUTPUTS
    The Mdm Bootstrap Module functions.

EXAMPLE
    Import-module Mdm_Bootstrap

NOTES
    I originally had each function a .ps1 file:
    I had issues. It is the "dot sourcing" issue found online.
    The solution needs Full Language Mode to run.
    ```powershell
        . "$PSScriptRoot\Assert-SecElevated.ps1"
        . "$PSScriptRoot\Export-ModuleMemberScan.ps1"
        . "$PSScriptRoot\Get-DirectoryNameFromSaved.ps1"
        . "$PSScriptRoot\Get-FilesNamesFromSaved.ps1"
        . "$PSScriptRoot\Set-SavedToDirectoryName.ps1"
        . "$PSScriptRoot\Set-LocationToPath"
        . "$PSScriptRoot\Wait-AnyKey.ps1"
        . "$PSScriptRoot\Wait-CheckDoPause.ps1"
        . "$PSScriptRoot\Wait-YorNorQ.ps1"
    ```
    I now have a module .psm1 file but the .ps1 file are components or classes:
    ```powershell
        . "$PSScriptRoot\Mdm_Std_Library.psm1"
        . "$PSScriptRoot\Mdm_Std_Help.ps1"
        . "$PSScriptRoot\Mdm_Std_Etl.ps1"
        . "$PSScriptRoot\Mdm_Std_Script.ps1"
        . "$PSScriptRoot\Mdm_Std_Error.ps1"
        . "$PSScriptRoot\Mdm_Std_Module.ps1"
    ```

    You have to dot source ". xxx" these in your .PSM1 file.
    Also: See function Export-ModuleMember. 
    This also failed for the same reasons.
    
    Regardless: This is powershell best practices,
    and similar to modules in the wild.
    Additionally, the PSM1 file get unwieldly large
    while using the above technique isolates the functions
    making them easier to find.

    (It seems) the main difference is they typically use .net (C#).
    That isn't a barrier beyond wanting to master (THIS) powershell syntax.

    SOLUTION: This was caused by the registry's environment setting:
        __PSLockDownPolicy
    This is 4 (Constrained) and needs to be (8) Full Language Mode
    Note: This reduces the security of the system. todo
    The bootstrap modules contains solution to alter this setting.
</pre>
<h2>Add-RegistryPath</h2>

<p><strong>Type:</strong> Function</p>
<p><strong>Synopsis:</strong> Add to HKLM Environtment Path</p>
<p><strong>Detailed Description:</strong> This loads the specifiect Path key (PATH by default) and adds the new path to it.</p>
<p><strong>Syntax:</strong> <pre>Add-RegistryPath
 description: The Path key to use.

 envPathToUpdate
 parameterValue: String, required: false, globbing: false, pipelineInput: false, position: 1</pre></p>
<p></p>
<p><strong>Parameters:</strong></p>
<p>  - <strong>envPathToUpdate</strong>: The Path key to use.</p>
<p></p>
<p><strong>Return: </strong> none.</p>
<p></p>
<p><strong>Examples</strong>:</p>
<pre>Example: -------------------------- EXAMPLE 1 --------------------------
Introduction: @{Text=PS C:\&gt;}
      Syntax: Add-RegistryPath &quot;PATH&quot; &quot;c:\SOMEWHERER&quot;
     Remarks:</pre>
<p></p>
<h2>Assert-RegistryValue</h2>



<p><strong>Type:</strong> Function</p>
<p><strong>Synopsis:</strong> Return true if Registry Value exists.</p>
<p><strong>Detailed Description:</strong> Check the registry path &amp; value. Asserts it exists.</p>
<p><strong>Syntax:</strong> <pre>Assert-RegistryValue
 description: The Registry Path to check.

 Path
 parameterValue: String, required: true, globbing: false, pipelineInput: false, position: 1 description: The Registry Key name (Value) to access.

 Name
 parameterValue: String, required: true, globbing: false, pipelineInput: false, position: 2 PassThru
 description: If true this outputs an ItemProperty otherwise true/false

 required: false, globbing: false, pipelineInput: false, position: named</pre></p>
<p></p>
<p><strong>Parameters:</strong></p>
<p>  - <strong>Path</strong>: The Registry Path to check.</p>
<p>  - <strong>Name</strong>: The Registry Key name (Value) to access.</p>
<p>  - <strong>PassThru</strong>: If true this outputs an ItemProperty otherwise true/false</p>
<p></p>
<p><strong>Return: </strong> True/Fale if the key exists.
null/ItemProperty if PassThur switch is present.</p>
<p></p>
<p><strong>Examples</strong>:</p>
<pre>Example: -------------------------- EXAMPLE 1 --------------------------
Introduction: @{Text=PS C:\&gt;}
      Syntax: Assert-RegistryValue &quot;PATH&quot;
     Remarks:</pre>
<p></p>
<h2>DevEnv_Install_Modules_Win</h2>












<p><strong>Type:</strong> Function</p>
<p><strong>Synopsis:</strong> Install or update Mdm Modules.</p>
<p><strong>Detailed Description:</strong> This installs the libraries to the live system using Robocopy.</p>
<p><strong>Syntax:</strong> <pre>DevEnv_Install_Modules_Win
 DoVerbose
 description: Provide detailed information.

 required: false, globbing: false, pipelineInput: false, position: named DoPause
 description: Switch to pause at each step/page.

 required: false, globbing: false, pipelineInput: false, position: named DoDebug
 description: Debug this script.

 required: false, globbing: false, pipelineInput: false, position: named description: default: "$global:projectRootPath\src\Modules"

 source
 parameterValue: String, required: false, globbing: false, pipelineInput: false, position: 1 description: default: "$env:PROGRAMFILES\\WindowsPowerShell\Modules"

 destination
 parameterValue: String, required: false, globbing: false, pipelineInput: false, position: 2 projectRootPath
 parameterValue: String, required: false, globbing: false, pipelineInput: false, position: 3 moduleRootPath
 parameterValue: String, required: false, globbing: false, pipelineInput: false, position: 4 description: default: "$global:projectRootPath\log\"

 logFilePath
 parameterValue: String, required: false, globbing: false, pipelineInput: false, position: 5 description: default: "Mdm_Installation_Log.txt"

 logFileName
 parameterValue: String, required: false, globbing: false, pipelineInput: false, position: 6 LogOneFile
 description: Switch to not create separate file with the date in the file name.

 required: false, globbing: false, pipelineInput: false, position: named description: Default is "Mmd_*". IE. These modules.
You could override it if you had other local modules to install

 nameFilter
 parameterValue: String, required: false, globbing: false, pipelineInput: false, position: 7 SkipHelp
 required: false, globbing: false, pipelineInput: false, position: named SkipRegistry
 required: false, globbing: false, pipelineInput: false, position: named SkipCopy
 required: false, globbing: false, pipelineInput: false, position: named DoNewWindow
 description: Switch to execute copy commands in a separate shell window.

 required: false, globbing: false, pipelineInput: false, position: named description: MacroDM currently. It's optional.

 companyName
 parameterValue: String, required: false, globbing: false, pipelineInput: false, position: 8 description: These are RoboCopy options.
Currently: "/E /FP /nc /ns /np /TEE"

 copyOptions
 parameterValue: String, required: false, globbing: false, pipelineInput: false, position: 9</pre></p>
<p></p>
<p><strong>Parameters:</strong></p>
<p>  - <strong>DoVerbose</strong>: Provide detailed information.</p>
<p>  - <strong>DoPause</strong>: Switch to pause at each step/page.</p>
<p>  - <strong>DoDebug</strong>: Debug this script.</p>
<p>  - <strong>source</strong>: default: &quot;$global:projectRootPath\src\Modules&quot;</p>
<p>  - <strong>destination</strong>: default: &quot;$env:PROGRAMFILES\\WindowsPowerShell\Modules&quot;</p>
<p>  - <strong>projectRootPath</strong></p>
<p>  - <strong>moduleRootPath</strong></p>
<p>  - <strong>logFilePath</strong>: default: &quot;$global:projectRootPath\log\&quot;</p>
<p>  - <strong>logFileName</strong>: default: &quot;Mdm_Installation_Log.txt&quot;</p>
<p>  - <strong>LogOneFile</strong>: Switch to not create separate file with the date in the file name.</p>
<p>  - <strong>nameFilter</strong>: Default is &quot;Mmd_*&quot;. IE. These modules.
You could override it if you had other local modules to install</p>
<p>  - <strong>SkipHelp</strong></p>
<p>  - <strong>SkipRegistry</strong></p>
<p>  - <strong>SkipCopy</strong></p>
<p>  - <strong>DoNewWindow</strong>: Switch to execute copy commands in a separate shell window.</p>
<p>  - <strong>companyName</strong>: MacroDM currently. It&apos;s optional.</p>
<p>  - <strong>copyOptions</strong>: These are RoboCopy options.
Currently: &quot;/E /FP /nc /ns /np /TEE&quot;</p>
<p></p>
<p><strong>Examples</strong>:</p>
<pre>Example: -------------------------- EXAMPLE 1 --------------------------
Introduction: @{Text=PS C:\&gt;}
      Syntax: DevEnv_Install_Modules_Win
     Remarks:</pre>
<p></p>
<h2>DevEnv_LanguageMode</h2>
<p><strong>Type:</strong> Function</p>
<p><strong>Synopsis:</strong> 
DevEnv_LanguageMode [[-languageMode] &lt;Object&gt;] [&lt;CommonParameters&gt;]</p>
<p><strong>Syntax:</strong> <pre>name: DevEnv_LanguageMode
CommonParameters: True
WorkflowCommonParameters: False
parameter: @{name=languageMode; required=false; pipelineInput=false; isDynamic=false; parameterSetName=(All); parameterValue=Object; type=; position=0; aliases=None}</pre></p>
<p></p>
<p><strong>Parameters:</strong></p>
<p>  - <strong>languageMode</strong></p>
<p></p>
<p><strong>Return: </strong> System.Object</p>
<p></p>
<p></p>
<h2>DevEnv_Module_Reset_Func</h2>
<p><strong>Type:</strong> Function</p>
<p><strong>Synopsis:</strong> 
DevEnv_Module_Reset_Func [&lt;CommonParameters&gt;]</p>
<p><strong>Syntax:</strong> <pre>name: DevEnv_Module_Reset_Func
CommonParameters: True
WorkflowCommonParameters: False
parameter:</pre></p>
<p></p>
<p><strong>Parameters:</strong></p>
<p></p>
<p><strong>Return: </strong> System.Object</p>
<p></p>
<p></p>
<h2>Initialize-Dev_Env_Win</h2>



<p><strong>Type:</strong> Function</p>
<p><strong>Synopsis:</strong> Setup (bootstrap) Windows for the Development Environment.</p>
<p><strong>Detailed Description:</strong> This is the first step of bootstrapping the Development Environment.
This updates the Windows Environment variables.
It installs these powershell modules to the system&apos;s directories.
Set registry, Path and load PowerShell modules.
$source = &quot;$global:moduleRootPath\&quot;
$destination = &quot;$Env:ProgramFiles\WindowsPowerShell\Modules&quot;</p>
<p><strong>Syntax:</strong> <pre>Initialize-Dev_Env_Win
 UpdatePath
 description: Switch: A switch to indicate the path should be checked/updated.

 required: false, globbing: false, pipelineInput: false, position: named DoPause
 description: Switch: Pause between steps.

 required: false, globbing: false, pipelineInput: false, position: named DoVerbose
 description: Switch: Verbose output and prompts.

 required: false, globbing: false, pipelineInput: false, position: named</pre></p>
<p></p>
<p><strong>Parameters:</strong></p>
<p>  - <strong>UpdatePath</strong>: Switch: A switch to indicate the path should be checked/updated.</p>
<p>  - <strong>DoPause</strong>: Switch: Pause between steps.</p>
<p>  - <strong>DoVerbose</strong>: Switch: Verbose output and prompts.</p>
<p></p>
<p><strong>Return: </strong> Preparse the Windows OS for development.</p>
<p></p>
<p><strong>Examples</strong>:</p>
<pre>Example: -------------------------- EXAMPLE 1 --------------------------
Introduction: @{Text=PS C:\&gt;}
      Syntax: Initialize-Dev_Env_Win -SilentMode -UpdatePath
     Remarks:</pre>
<p></p>
<footer><p>&copy; David G. Horsman. All rights reserved.</p></footer>
    <!-- <footer><p>{{Footer}}&copy; David G. Horsman. All rights reserved.</p></footer> -->
</body>
</html>
